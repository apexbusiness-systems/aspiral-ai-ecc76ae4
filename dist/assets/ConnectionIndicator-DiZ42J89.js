import{j as e}from"./react-query-1zeL9f71.js";import{r as t,b as n}from"./react-vendor-BIu81k28.js";import{c as o,j as i}from"./index-C2YmphIk.js";import{p as r}from"./performanceOptimizations-DPwb1cGZ.js";import"./radix-primitives-Di8eIdiq.js";import"./radix-overlays-68Wd_bDx.js";import"./supabase-Ds_TnZEi.js";import"./react-router-BwMFiyVe.js";import"./radix-forms-KIAltt28.js";
/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a=o("signal-high",[["path",{d:"M2 20h.01",key:"4haj6o"}],["path",{d:"M7 20v-4",key:"j294jx"}],["path",{d:"M12 20v-8",key:"i3yub9"}],["path",{d:"M17 20V8",key:"1tkaf5"}]]),l=o("signal-low",[["path",{d:"M2 20h.01",key:"4haj6o"}],["path",{d:"M7 20v-4",key:"j294jx"}]]),s=o("signal-medium",[["path",{d:"M2 20h.01",key:"4haj6o"}],["path",{d:"M7 20v-4",key:"j294jx"}],["path",{d:"M12 20v-8",key:"i3yub9"}]]),u=o("signal",[["path",{d:"M2 20h.01",key:"4haj6o"}],["path",{d:"M7 20v-4",key:"j294jx"}],["path",{d:"M12 20v-8",key:"i3yub9"}],["path",{d:"M17 20V8",key:"1tkaf5"}],["path",{d:"M22 4v16",key:"sih9yq"}]]),c=o("wifi-off",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),d=[1e3,2e3,4e3];function f(e){if(!e)return"unknown";const t=e.effectiveType;return"wifi"===e.type?"wifi":"4g"===t&&e.downlink&&e.downlink>10?"5g":"4g"===t?"4g":"3g"===t?"3g":"2g"===t||"slow-2g"===t?"2g":"unknown"}function m(e,t,n,o){return"4g"===t&&n&&n>10?"excellent":"4g"===t||"3g"===t||n&&n>1.5?"good":"slow"}function p(e,t,n){return n&&"offline"!==e?"excellent"===t?`Connected with ${"wifi"===e?"WiFi":e.toUpperCase()} - Excellent connection.`:"good"===t?`Connected with ${"wifi"===e?"WiFi":e.toUpperCase()} - Good connection.`:"slow"===t?`Connected with ${"wifi"===e?"WiFi":e.toUpperCase()} - Slow connection. Some features may be limited.`:"Connection status: "+(n?"Online":"Offline"):"You are currently offline. Some features may be unavailable."}const y=n.memo(({showOnlyWhenIssues:n=!0,position:o="bottom-right",className:y})=>{const{status:h,queuedRequestCount:v}=function(){const[e,n]=t.useState(()=>{const e="undefined"==typeof navigator||navigator.onLine,t=navigator,n=t.connection||t.mozConnection||t.webkitConnection;return{online:e,type:e?f(n):"offline",quality:e?m(0,null==n?void 0:n.effectiveType,null==n?void 0:n.downlink,null==n||n.rtt):"offline",downlink:null==n?void 0:n.downlink,rtt:null==n?void 0:n.rtt,effectiveType:null==n?void 0:n.effectiveType,saveData:null==n?void 0:n.saveData}}),o=t.useRef(new Map),i=t.useRef(new Map),r=t.useCallback(()=>{const e=navigator.onLine,t=navigator,i=t.connection||t.mozConnection||t.webkitConnection,r={online:e,type:e?f(i):"offline",quality:e?m(0,null==i?void 0:i.effectiveType,null==i?void 0:i.downlink,null==i||i.rtt):"offline",downlink:null==i?void 0:i.downlink,rtt:null==i?void 0:i.rtt,effectiveType:null==i?void 0:i.effectiveType,saveData:null==i?void 0:i.saveData};n(r),e&&o.current.size>0&&s()},[]),a=t.useCallback((t,n)=>{const i=n||`req_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return new Promise((n,r)=>{const a={id:i,request:t,retries:0,timestamp:Date.now(),resolve:n,reject:r};o.current.set(i,a),e.online&&l(a)})},[e.online]),l=t.useCallback(async e=>{try{const t=await e.request();e.resolve(t),o.current.delete(e.id),i.current.delete(e.id)}catch(t){if(e.retries++,e.retries>=3)return e.reject(t),o.current.delete(e.id),void i.current.delete(e.id);const n=d[e.retries-1]||4e3,r=setTimeout(()=>{l(e),i.current.delete(e.id)},n);i.current.set(e.id,r)}},[]),s=t.useCallback(()=>{e.online&&o.current.forEach(e=>{i.current.has(e.id)||l(e)})},[e.online,l]),u=t.useCallback(()=>{o.current.forEach(e=>{e.reject(new Error("Request queue cleared"))}),o.current.clear(),i.current.forEach(e=>clearTimeout(e)),i.current.clear()},[]);return t.useEffect(()=>{r(),window.addEventListener("online",r),window.addEventListener("offline",r);const e=navigator,t=e.connection||e.mozConnection||e.webkitConnection;return(null==t?void 0:t.addEventListener)&&t.addEventListener("change",r),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",r),(null==t?void 0:t.removeEventListener)&&t.removeEventListener("change",r),i.current.forEach(e=>clearTimeout(e))}},[r]),{status:e,isOnline:e.online,isOffline:!e.online,networkType:e.type,connectionQuality:e.quality,queueRequest:a,clearQueue:u,hasQueuedRequests:o.current.size>0,queuedRequestCount:o.current.size}}(),[w,k]=t.useState(!1),[g,x]=t.useState(!1);t.useEffect(()=>{k(!n||(!h.online||"slow"===h.quality||"offline"===h.quality))},[h.online,h.quality,n]),t.useEffect(()=>{if(!w||g)return;const e=p(h.type,h.quality,h.online),t=document.createElement("div");t.setAttribute("role","status"),t.setAttribute("aria-live","polite"),t.setAttribute("aria-atomic","true"),t.className="sr-only",t.textContent=e,document.body.appendChild(t);const n=setTimeout(()=>{document.body.contains(t)&&document.body.removeChild(t),x(!0)},1e3);return()=>{clearTimeout(n),document.body.contains(t)&&document.body.removeChild(t)}},[w,h.type,h.quality,h.online,g]),t.useEffect(()=>{x(!1)},[h.online,h.type,h.quality]);if(!w)return null;const b=!r(),j=p(h.type,h.quality,h.online),q=function(e){switch(e){case"excellent":return"text-success dark:text-green-400";case"good":return"text-info dark:text-blue-400";case"slow":return"text-amber-800 dark:text-yellow-400";case"offline":return"text-red-700 dark:text-red-400";default:return"text-muted-foreground"}}(h.quality);return e.jsxs("div",{className:i("fixed z-50 flex items-center gap-2 rounded-lg border bg-background/95 backdrop-blur-sm px-3 py-2 shadow-lg",{"top-right":"top-4 right-4","bottom-right":"bottom-4 right-4","bottom-left":"bottom-4 left-4","top-left":"top-4 left-4"}[o],b&&"animate-in slide-in-from-bottom-2",y),role:"status","aria-live":"polite","aria-label":j,children:[e.jsx("div",{className:i("flex-shrink-0",q),children:(C=h.type,M=h.quality,"offline"===C||"offline"===M?e.jsx(c,{className:"h-4 w-4"}):"excellent"===M||"wifi"===C||"5g"===C?e.jsx(a,{className:"h-4 w-4"}):"good"===M||"4g"===C?e.jsx(s,{className:"h-4 w-4"}):"slow"===M?e.jsx(l,{className:"h-4 w-4"}):e.jsx(u,{className:"h-4 w-4"}))}),e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("span",{className:"text-xs font-medium truncate",children:h.online?"slow"===h.quality?"Slow Connection":"Connected":"Offline"}),v>0&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:[v," request",v>1?"s":""," queued"]})]}),e.jsx("span",{className:"sr-only",children:j})]});var C,M});export{y as ConnectionIndicator};
